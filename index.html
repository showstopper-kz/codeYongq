
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>精神时间屋</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="精神时间屋">
<meta property="og:url" content="https://codeyongqi.github.io/index.html">
<meta property="og:site_name" content="精神时间屋">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="朱勇麒">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="精神时间屋" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.0"></head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">精神时间屋</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="codeYongqi.github.io">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main">
  
    <article id="post-数据库并发处理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/04/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E5%A4%84%E7%90%86/" class="article-date">
  <time datetime="2021-04-12T12:43:50.000Z" itemprop="datePublished">2021-04-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/04/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E5%A4%84%E7%90%86/">数据库并发处理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数据库并发处理"><a href="#数据库并发处理" class="headerlink" title="数据库并发处理"></a>数据库并发处理</h1><h2 id="并发控制概述"><a href="#并发控制概述" class="headerlink" title="并发控制概述"></a>并发控制概述</h2><p>数据库的并发控制单位是事务，数据库在并发处理事务的时候要保证事务的ACID特性。对事务的并发调度进行控制主要是为了保证事务的一致性和隔离性</p>
<h3 id="并发带来的问题"><a href="#并发带来的问题" class="headerlink" title="并发带来的问题"></a>并发带来的问题</h3><p>1.修改丢失</p>
<p>两个事务同时对同一个事务进行修改，后一个事务提交之后会覆盖第一个事务对数据的修改</p>
<p>2.不可重复读</p>
<p>不可重复度有三种情况。a.某个数据在事务第一次读取后发生了修改，第二次读到的值和第一次不一样 b.事务1在读取数据之后，事务2删除了这部分数据，事务1再读取就会发现数据消失了 c.事务1在读取数据之后，事务2插入了一些数据，事务1再读取发现数据多了。b和c这两种情况也称为幻读</p>
<p>3.脏读</p>
<p>脏读顾名思义，读到的数据是“脏”的，与数据库里的真实数据不一致。当事务1对数据库修改之后，事务2读取该部分数据，若此时事务1发生故障进行回滚，则此时事务2读到的数据就是“脏”的</p>
<h3 id="封锁和封锁协议"><a href="#封锁和封锁协议" class="headerlink" title="封锁和封锁协议"></a>封锁和封锁协议</h3><p>并发带来了一些问题，我们通过加锁来解决这些问题。首先介绍两种锁，写锁（X锁）和读锁（S锁）。若事务A对某一数据加上了写锁，则只允许事务A读写该数据，且别的事务不能对该数据加任何类型的锁，直到A释放写锁为止，所以当事务A对数据修改时，其它任何事务不能读写该数据。若事务A加的是读锁，则其它事务只能对该数据再加读锁，所有事务都只能读取该数据。数据库通过对这两种锁的组合使用来解决并发的问题。</p>
<p>封锁协议有三个级别，级别越高越复杂，数据也更安全。第一级封锁协议是指在修改数据的时候必须加X锁，这样就可以解决上面修改丢失的问题。第二级封锁协议在第一级的基础上又增加了在读数据之前必须加S锁，这样就避免了读取脏数据问题，因为S锁只能在没有加X锁的情况下才能加，所以事务1执行结束之后才能对该数据进行读取。第三级封锁协议在第一级的基础上增加了在读数据之前必须加S锁，且等到事务结束之后才会释放S锁，第三级协议解决了不可重复度问题，因为在事务结束之前其它的事务不能对该数据进行修改。</p>
<p>活锁和死锁</p>
<p>假如现在事务1对数据加锁了，事务2请求加锁，事务3请求加锁等等。在事务1结束之后，系统很有可能先批准事务3，然后事务4以此类推，最终造成事务2可能永远等待，我们把这种<strong>可能永远等待</strong>的情况成为活锁，解决方式是使用FIFO策略。如果事务1加锁数据a，请求数据b，而此时事务2加锁数据b请求数据a，这就坏了，形成了死锁。从这里我们也可以看出形成死锁的几个条件</p>
<ul>
<li>互斥，一段时间只能有一个事务占有数据</li>
<li>请求与保持，事务占有数据且请求另一数据</li>
<li>不可剥夺，事务占有了就不能被剥夺</li>
<li>循环等待，事物之间形成循环等待</li>
</ul>
<p>在数据库系统中采用超时法和等待图法来判断死锁，如果某一事务超出时间限制或在等待图中检测出环，就认为此时数据库系统中出现了死锁，出现死锁之后数据库系统会选择一个代价最小的事务强制撤销释放它的所有锁。这也对应了上一篇文章中数据库事务中事务内部的非预期故障，只能通过日志文件回滚。</p>
<h3 id="并发调度要求"><a href="#并发调度要求" class="headerlink" title="并发调度要求"></a>并发调度要求</h3><p><strong>可串行性</strong>是并发调度的基本准则，可串行性是指并发调度获得的结果与串行执行这些事务获得的结果相同。</p>
<p>两段锁协议（2PL）协议是数据库系统普遍采用的并发控制协议。两段锁协议，任何事务在读写数据的时候都要加锁，在第一阶段，事务只能申请锁，不能释放任何锁，在第二阶段只能释放锁不能再申请新的锁，可以证明遵守两段锁协议的事务并发操作是可串行化的</p>
<p>封锁对象的大小称为封锁粒度。封锁粒度决定了并发度与开销，封锁粒度越小安全性越高，但是开销是巨大的。我们不是在所有时候都需要粒度小的封锁，比如说在读取数据的时候我们只需要对着一张表加锁就行了，而在修改数据的时候，如果我们能对每一个元组加锁，那么就可以支持更多的事务同时对表修改，并发度更高。所以在数据库系统中，多粒度封锁是最好的。</p>
<p>多粒度封锁是通过多粒度树来实现的，多粒度树按不同的范围划分了每一层的节点，根节点为数据库，越往下粒度越小。这里要注意一件事，<strong>如果在树中某一个节点加了锁，那么它所有的子节点就会被加该锁</strong>加在子节点上的锁也称隐式封锁，所以要对一个节点加X锁时，就要检查它上层和下层是否加上了S锁，这样是非常消耗时间的，所以我们引入了一种新的类型的锁，意向锁。</p>
<p>意向锁主要有三种IS锁，IX锁，SIX锁</p>
<p>IS锁指它的子节点有可能加S锁，同理IX锁指它的子节点有可能加X锁，SIX锁指先加S锁再加IX锁，比如对整个表加S锁，更新表中某些元素，所以加IX锁，通过引入意向锁，就只要判断上层节点是否存在中出，不需要再检查子节点</p>
<h3 id="MVCC"><a href="#MVCC" class="headerlink" title="MVCC"></a>MVCC</h3><p>MVCC是另一种并发控制技术，它维护数据库中对象多个版本，记录数据在多个时候的状态</p>
<p>若版本Q<sub>k</sub>具有 &lt;= TS(T)的最大时间戳，则</p>
<p>若事务T发出read(Q) 则 return Q<sub>k</sub></p>
<p>若事务T发出write(Q)</p>
<p>if TS(T) &lt; R-timestamp(Q<sub>k</sub>)，ROLLBACK T</p>
<p>if TS(T) = W-timestamp(Q<sub>k</sub>)，覆盖Q<sub>k</sub>的内容</p>
<p>否则创建新版本</p>
<p>MVCC 有利于提高事务的并发度，但是会产生大量无效版本，而且事务结束的时候，无法确定被影响元组的有效性</p>
<p>将几种并发控制方式结合可以得到新的协议MV2PL，即对于更新事务采取2PL协议，对于只读事务采取MVCC协议</p>
<h3 id="MYSQL事务隔离级别"><a href="#MYSQL事务隔离级别" class="headerlink" title="MYSQL事务隔离级别"></a>MYSQL事务隔离级别</h3><table>
<thead>
<tr>
<th align="left">隔离级别</th>
<th align="left">脏读（Dirty Read）</th>
<th align="left">不可重复读（NonRepeatable Read）</th>
<th align="left">幻读（Phantom Read）</th>
</tr>
</thead>
<tbody><tr>
<td align="left">未提交读（Read uncommitted）</td>
<td align="left">可能</td>
<td align="left">可能</td>
<td align="left">可能</td>
</tr>
<tr>
<td align="left">已提交读（Read committed）</td>
<td align="left">不可能</td>
<td align="left">可能</td>
<td align="left">可能</td>
</tr>
<tr>
<td align="left">可重复读（Repeatable read）</td>
<td align="left">不可能</td>
<td align="left">不可能</td>
<td align="left">可能</td>
</tr>
<tr>
<td align="left">可串行化（Serializable ）</td>
<td align="left">不可能</td>
<td align="left">不可能</td>
<td align="left">不可能</td>
</tr>
</tbody></table>
<ul>
<li>未提交读(Read Uncommitted)：允许脏读，也就是可能读取到其他会话中未提交事务修改的数据</li>
<li>提交读(Read Committed)：只能读取到已经提交的数据。Oracle等多数数据库默认都是该级别 (不重复读)</li>
<li>可重复读(Repeated Read)：可重复读。在同一个事务内的查询都是事务开始时刻一致的，InnoDB默认级别。在SQL标准中，该隔离级别消除了不可重复读，但是还存在幻象读</li>
<li>串行读(Serializable)：完全串行化的读，每次读都需要获得表级共享锁，读写相互都会阻塞</li>
</ul>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/04/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E5%A4%84%E7%90%86/" data-id="cko7betf4000iqqsef7qobbpw" class="article-share-link" data-share="baidu" data-title="数据库并发处理">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/04/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E5%A4%84%E7%90%86/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-数据库事务" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/04/09/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1/" class="article-date">
  <time datetime="2021-04-09T14:23:12.000Z" itemprop="datePublished">2021-04-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/04/09/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1/">数据库事务</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数据库事务"><a href="#数据库事务" class="headerlink" title="数据库事务"></a>数据库事务</h1><h2 id="事务的特性"><a href="#事务的特性" class="headerlink" title="事务的特性"></a>事务的特性</h2><p>事务具有四个特性，原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）、持久性（Durability），简称ACID</p>
<p>（1）原子性</p>
<p>这个比较容易理解，事务中的一系列操作（增删改查）要么都做，要么都不做。</p>
<p>（2）一致性</p>
<p>一致性指数据库中只包含事务成功提交的结果，未完成的事务对数据库的修改不会提交到数据库。比如说一个事务中同时包含两个update操作，当只有一个update完成的时候，修改最终不会在物理数据库中保留。当全部做完了以后就会COMMIT，将对数据库的修改写到磁盘上，若事务不能正常进行，则会进行ROLLBACK回滚，将事务已完成的操作撤销。</p>
<p>（3）隔离性</p>
<p>即多个事务可以并发操作，不会相互干扰</p>
<p>（4）持久性</p>
<p>持久性指当一个事务成功提交以后，它对数据库的修改一定会写入物理数据库。后续发生的故障不会对其产生影响</p>
<h2 id="故障介绍与处理"><a href="#故障介绍与处理" class="headerlink" title="故障介绍与处理"></a>故障介绍与处理</h2><h3 id="故障介绍"><a href="#故障介绍" class="headerlink" title="故障介绍"></a>故障介绍</h3><p>数据库运行的故障主要有两类，事务内部的故障和事务运行时的故障，还有介质故障（主要属于物理故障）</p>
<p>事务内部的故障包含预期和非预期，大部分指非预期的故障，这种故障无法在程序中进行处理。如产生并发死锁的时候选中了该事务对其强制撤销。对这类问题解决的操作称为事务撤销，对应有（UNDO LOG）。</p>
<p>下面代码展示的是一个可预期的故障，如果余额小于0则会导致回滚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">IF(BALANCE &lt; 0)THEN</span><br><span class="line">	&#123;ROLLBACK;&#125;</span><br><span class="line">ELSE </span><br><span class="line">	&#123;BALANCE1 &#x3D; BALANCE1 + AMOUNT;</span><br><span class="line">	COMMIT;&#125;</span><br></pre></td></tr></table></figure>

<p>事务运行时的故障指数据库在运行时遭遇意外的停止，如最运行时断电。当发生故障后，数据库中存在未完成的事务和已提交的事务，对于未完成的事务，由于其有可能已经对数据库进行了修改，无法保证事务的一致性，所以需要对所有未完成的事务进行强制撤销。对于已经提交的事务，它可能还来不及写入物理数据库中，所以当数据库重新启动时，需要对这一部分数据重做，对应有（REDO LOG）</p>
<h3 id="故障恢复技术"><a href="#故障恢复技术" class="headerlink" title="故障恢复技术"></a>故障恢复技术</h3><p>对于故障的解决办法是通过冗余，是的，你没听错。原理非常简单，就是在系统另外的地方存储冗余数据。冗余数据的建立有两种常见的技术，一是数据转储，还有一个是登记日志文件。</p>
<p>数据转储就是定期对整个数据库进行拷贝得到副本，在数据库遭到破坏时，将副本重装。注意在重装以后数据库只能恢复到拷贝时候的状态，还需要重新运行拷贝后的所有事务。“拷贝”这个词听起来就非常麻烦，它很花时间，还很消耗资源。我们直觉上会认为在拷贝的时候，是不能有其它事务在运行的，要不然的得到的数据就不准确了。没错，但是拷贝这么长的时间，难道我们只能傻傻地等着吗？好在我们有另外的方法可以使得在拷贝的时候也可以运行事务，这种方式是动态的，因此我们把它称为动态转储，相应地前面那一种方法就称为静态转储。</p>
<p>对于前面的介绍，可能你已经产生了疑问，动态转储如何保证数据的准确性呢，答案就是日志文件，日志文件会记录在转储过程中所有事务对数据库的修改记录，有了日志文件再结合副本就可以得到恢复到正确状态。下面来介绍一下日志文件</p>
<p>首先要记住在数据库中最重要的一点，事务执行是<strong>先写日志文件，后写数据库</strong>的，这是最基本的要求。日志文件大致可分为两种格式，以记录为单位和以数据块为单位。日志文件会记录事务的开始和结束标记（注意，ROLLBACK也是结束标记），并且还会记录更新前和更新后的值，日志文件严格按照事务执行的时间来记录。日志文件能应用到动态转储中，那么我们可不可以也将它应用到静态转储中，这样在重装完副本就不用执行所有的事务了，答案当然是可以的，事实上很多时候我们就是这么做的。</p>
<p>总结一下，对于故障的解决办法就是增加数据的记录，静态转储不一定需要日志，动态转储必须要有日志，另外在转储的时候还分为海量转储和增量转储，顾名思义，海量转储就是记录全部数据库，增量转储只会记录上一次转储后更新的部分。因此转储方式共有四种，对于不同的情况，我们可以选择不同的转储方式。</p>
<h3 id="故障恢复过程"><a href="#故障恢复过程" class="headerlink" title="故障恢复过程"></a>故障恢复过程</h3><p>对于事务内部故障的恢复，可分为几个步骤，这部分对数据库用户来说是透明的</p>
<p>（1）反向扫描日志文件，查找更新操作</p>
<p>（2）对更新操作进行“逆操作”，即删除改为插入，插入改为删除，更新后的值改为更新前的值</p>
<p>（3）继续扫描，并执行对应操作，直到该事务的开始标记</p>
<p>对于系统故障的恢复则要多出一个重做的步骤</p>
<p>（1）正向扫描日志文件，将已经提交的事务加入到重做队列（REDO-LIST）中，未完成的事务加入到撤销队列（UNDO-LIST）中</p>
<p>（2）对撤销队列中的每个事务进行撤销操作</p>
<p>（3）对重做队列中的每个事务进行重做操作</p>
<p>对于介质故障的恢复</p>
<p>（1）重装数据库副本，恢复至一致性状态</p>
<p>（2）扫描日志，将已经提交的事务加入重做队列（REDO-LIST），对重做队列中事务进行重做</p>
<p>利用日志来恢复数据库非常方便，但是也存在一些问题。例如搜索日志会花费大量的时间而且并不是重做队列中所有的事务都是需要重做的，由此产生了带有检查点的恢复技术。检查点技术就是在日志中添加检查点并用一个重新开始文件来记录检查点在日志文件中的位置，其核心思想就是<strong>确保在检查点位置加入重新开始文件之前所有数据修改都已经写入磁盘，因此在检查点之前提交的事务一定已经写入数据库</strong></p>
<h2 id="数据库镜像"><a href="#数据库镜像" class="headerlink" title="数据库镜像"></a>数据库镜像</h2><p>对于数据库的故障，即使是完全恢复也会消耗大量的时间，DBA必须周期地对数据库进行拷贝，而一旦出现严重的故障，就会造成巨大损失。而数据库镜像可以解决这个问题，他的原理是用另一块磁盘将主数据库完全拷贝并且与主数据库保持完全一致。当出现介质故障的时候，镜像磁盘可以继续使用，并且镜像磁盘还可以用于并发操作。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/04/09/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1/" data-id="cko7betf2000fqqse94zg4uma" class="article-share-link" data-share="baidu" data-title="数据库事务">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/04/09/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1/#ds-thread" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hit-oslab-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/16/hit-oslab-1/" class="article-date">
  <time datetime="2021-03-16T09:01:28.000Z" itemprop="datePublished">2021-03-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/16/hit-oslab-1/">哈工大操作系统实验 Hit-oslab 环境搭建指南</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文为网易云课堂李治军老师操作系统系列课程实验的在Mac(win)上的本地环境搭建指南</p>
<h3 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h3><p>网易云课堂上这门课配套的实验环境是在<a target="_blank" rel="noopener" href="https://www.lanqiao.cn/courses/115">蓝桥云课</a>上的，它的在线环境虽然用起来非常方便，但是非会员环境只能保存一个小时，不适合较复杂的实验。所以我决定在本地搭建实验环境</p>
<p>本机系统：macOS Big Sur</p>
<h3 id="准备工作："><a href="#准备工作：" class="headerlink" title="准备工作："></a>准备工作：</h3><ul>
<li><p>VMWARE Fusion(win对应的为VMware tools)，这个自行安装</p>
</li>
<li><p>Ubuntu镜像我使用的版本的是18.04.5</p>
<p>建议到Ubuntu官网上选择合适的版本自行下载 <a target="_blank" rel="noopener" href="https://cn.ubuntu.com/download">https://cn.ubuntu.com/download</a></p>
<p>如果你不想找，也可以从我的百度网盘上下载，如果你有会员的话</p>
<p>下载链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1m0Cwnorp04LgBG-yYe0Vkg">https://pan.baidu.com/s/1m0Cwnorp04LgBG-yYe0Vkg</a>  密码: k0k2</p>
</li>
<li><p>linux基本命令使用</p>
<h2 id="开始搭建环境"><a href="#开始搭建环境" class="headerlink" title="开始搭建环境"></a>开始搭建环境</h2></li>
</ul>
<h3 id="安装Ubuntu虚拟机"><a href="#安装Ubuntu虚拟机" class="headerlink" title="安装Ubuntu虚拟机"></a>安装Ubuntu虚拟机</h3><p>首先在VMware中新建虚拟机，选择相应的镜像</p>
<p><img
src="https://gitee.com/codeYongqi/picgo-picture-bed/raw/master/img/EEBEB85C-68FD-40B3-9AB0-2BEC1C3732F9.png" alt="EEBEB85C-68FD-40B3-9AB0-2BEC1C3732F9" style="zoom:50%;" /></p>
<p>设置用户名密码，这里推荐两个用户名都用一样的并且用英文</p>
<img src="https://gitee.com/codeYongqi/picgo-picture-bed/raw/master/img/5B2BA486D98B6C8423E7B77FF4D3A985.png" alt="5B2BA486D98B6C8423E7B77FF4D3A985" style="zoom: 50%;" />

<p>完成虚拟机创建，进入系统</p>
<img src="https://gitee.com/codeYongqi/picgo-picture-bed/raw/master/img/3AE12851AF251289CF31BE7179CDCB07.png" alt="3AE12851AF251289CF31BE7179CDCB07" style="zoom:50%;" />



<h3 id="配置好Ubuntu开发环境"><a href="#配置好Ubuntu开发环境" class="headerlink" title="配置好Ubuntu开发环境"></a>配置好Ubuntu开发环境</h3><ul>
<li><p>安装gcc 3.4版本，参考此篇文章</p>
<p>文章中关于gcc 3.4dev的几个软件包寻找非常麻烦，我将它打包上传到了百度网盘</p>
<p>文件链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hvt4UMLCO1ejfw8WCe0OCw">https://pan.baidu.com/s/1hvt4UMLCO1ejfw8WCe0OCw</a>  密码: rd10</p>
<p>文章链接: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/mirage-mc/p/12681366.html">https://www.cnblogs.com/mirage-mc/p/12681366.html</a></p>
</li>
<li><p>安装gdb调试器，参考此篇文章<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mirage-mc/p/12683481.html">https://www.cnblogs.com/mirage-mc/p/12683481.html</a></p>
<p>只需要安装这三个包    </p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install bin86</span><br><span class="line">sudo apt-get install gcc-multilib</span><br><span class="line">sudo apt-get install build-essential</span><br></pre></td></tr></table></figure>

<p>至此，Ubuntu环境已安装完成</p>
<h2 id="编译第一个内核"><a href="#编译第一个内核" class="headerlink" title="编译第一个内核"></a>编译第一个内核</h2><h3 id="准备oslab环境"><a href="#准备oslab环境" class="headerlink" title="准备oslab环境"></a>准备oslab环境</h3><p>将hit-oslab 实验环境的压缩包拖到虚拟机中,我将压缩包放到了桌面</p>
<p>实验包下载链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1-VpBJ2Gx-hzXWIrKOSOZxg">https://pan.baidu.com/s/1-VpBJ2Gx-hzXWIrKOSOZxg</a>  密码: 1wat</p>
<p>在桌面右击，点击terminal打开终端</p>
<p><strong>Linux命令</strong></p>
<p><code>cd 压缩包目录 </code>  切换工作目录</p>
<p><code>cd.. </code>  返回上一层</p>
<p><code>tar -zxvf hit-oslab-linux-20110823.tar.gz </code> 解压文件</p>
<p>另外，在Ubuntu中复制粘贴命令和mac(win)不一样，可以在中断选中内容右击，copy为复制，paste粘贴</p>
<p><img src="https://gitee.com/codeYongqi/picgo-picture-bed/raw/master/img/151BDC6D-D823-4B77-8537-E1EEF4F7AA78.png" alt="151BDC6D-D823-4B77-8537-E1EEF4F7AA78"></p>
<h3 id="内核编译"><a href="#内核编译" class="headerlink" title="内核编译"></a>内核编译</h3><ul>
<li>切换到内核目录</li>
</ul>
<pre><font color="#8AE234"><b>kirin@ubuntu</b></font>:<font color="#729FCF"><b>~/Desktop</b></font>$ cd oslab/linux-0.11/
</pre>

<ul>
<li>编译内核</li>
</ul>
<pre><font color="#8AE234"><b>kirin@ubuntu</b></font>:<font color="#729FCF"><b>~/Desktop/oslab/linux-0.11</b></font>$ make all
</pre>

<p>编译的时候只会对内核代码更改的部分进行编译，如果想要清空之前的编译内容可使用<code>make clean</code>命令</p>
<h3 id="内核运行"><a href="#内核运行" class="headerlink" title="内核运行"></a>内核运行</h3><p>切换到运行目录并运行</p>
<pre><font color="#8AE234"><b>kirin@ubuntu</b></font>:<font color="#729FCF"><b>~/Desktop/oslab/linux-0.11</b></font>$ cd ..
<font color="#8AE234"><b>kirin@ubuntu</b></font>:<font color="#729FCF"><b>~/Desktop/oslab</b></font>$ ./run
</pre>
<p>运行成功如图所示，会弹出模拟器的对话框，可以尝试输入一些命令</p>
<p><img src="/Users/zhuyongqi/Desktop/E1638E64-6E36-415A-B586-55EB493208D6.png" alt="E1638E64-6E36-415A-B586-55EB493208D6"></p>
<h2 id="问题解答"><a href="#问题解答" class="headerlink" title="问题解答"></a>问题解答</h2><p>初学者在安装，使用Linux系统会遇到很多问题，例如一些重要的软件，包等未安装等。在这个这个环境搭建的过程中，碰到的问题大概可以分为以下几类</p>
<h3 id="Command-not-found"><a href="#Command-not-found" class="headerlink" title="Command *** not found"></a>Command *** not found</h3><p>这种问题一般都是软件，程序为安装导致的，如这个系统并未安装JRE，在执行java指令的时候就会产生如下错误</p>
<p><img src="https://gitee.com/codeYongqi/picgo-picture-bed/raw/master/img/42C9EB54-0967-40F3-B2E3-86D40F2CAA32.png" alt="42C9EB54-0967-40F3-B2E3-86D40F2CAA32"></p>
<p>出现这种情况，只要执行</p>
<p><code>sudo apt install 对应的软件包名</code>或者<code>sudo apt-get install 对应的软件包名</code></p>
<p>sudo执行的时候会让你输入用户密码，密码是隐藏的，输入之后回车就好了</p>
<h3 id="编译时产生的错误"><a href="#编译时产生的错误" class="headerlink" title="编译时产生的错误"></a>编译时产生的错误</h3><p>例如这样的报错</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">error while loading shared libraries: libSM.so.6: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure>

<p>需要安装对应的32位库</p>
<p><code>sudo apt-get install libsm6:i386</code></p>
<p>具体解决办法可参考这篇文章 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/tradoff/p/5693710.html">https://www.cnblogs.com/tradoff/p/5693710.html</a></p>
<p>至此，搭建哈工大操作系统实验 Hit-oslab 环境已全部结束</p>
<p>有问题清通过邮箱与我交流 </p>
<p><a href=mailto:zhuyongqi9@gmail.com>send email to me</a></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/03/16/hit-oslab-1/" data-id="cko7betez000bqqse5wjveiu9" class="article-share-link" data-share="baidu" data-title="哈工大操作系统实验 Hit-oslab 环境搭建指南">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/03/16/hit-oslab-1/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-2021-3-9" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/09/2021-3-9/" class="article-date">
  <time datetime="2021-03-09T07:57:40.000Z" itemprop="datePublished">2021-03-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python3-2021%E6%98%A5/">Python3_2021春</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/09/2021-3-9/">2021-3-9</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><h3 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h3><p>+可用于list等 object 连接</p>
<p>/：算术除法</p>
<p>//：和java一样</p>
<p>** 二次方</p>
<p>pow(3,2,8) == 3^2 % 8;</p>
<h3 id="关系运算符"><a href="#关系运算符" class="headerlink" title="关系运算符"></a>关系运算符</h3><p>1 &lt; 3 &lt; 5 可以连用 1&lt;3 &gt;2</p>
<p>&lt; 会以第一个元素比较列表大小(同类型)</p>
<p>随机数 range(1,10,1)</p>
<p>for i in (2,4,5):</p>
<p>is 比较是否相等 ==(内存地址)</p>
<h3 id="集合运算符"><a href="#集合运算符" class="headerlink" title="集合运算符"></a>集合运算符</h3><p>{1,2,3} | {3,4,5} 并集(自动去除重复元素)</p>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><p>and or not 相当于java中长路&amp;&amp;</p>
<h2 id="numpy"><a href="#numpy" class="headerlink" title="numpy"></a>numpy</h2><p><code>x=np.ones(3)</code></p>
<p><code>m=np.eye(3)*3</code>单位矩阵</p>
<p>py没有自增</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/03/09/2021-3-9/" data-id="cko7beteg0003qqsehvgwaapx" class="article-share-link" data-share="baidu" data-title="2021-3-9">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/03/09/2021-3-9/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  
    <article id="site-技术文章翻译" class="article article-type-site" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/08/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/" class="article-date">
  <time datetime="2021-03-07T16:49:08.000Z" itemprop="datePublished">2021-03-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/08/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/">技术文章翻译</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/03/08/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/" data-id="cko7betf1000eqqse1i19btyy" class="article-share-link" data-share="baidu" data-title="技术文章翻译">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/03/08/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-自定义PAC" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/08/%E8%87%AA%E5%AE%9A%E4%B9%89PAC/" class="article-date">
  <time datetime="2021-03-07T16:47:24.000Z" itemprop="datePublished">2021-03-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/">技术文章翻译</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/08/%E8%87%AA%E5%AE%9A%E4%B9%89PAC/">自定义PAC</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ABP-广告拦截器规则-可用于自定义PAC拦截"><a href="#ABP-广告拦截器规则-可用于自定义PAC拦截" class="headerlink" title="ABP 广告拦截器规则(可用于自定义PAC拦截)"></a>ABP 广告拦截器规则(可用于自定义PAC拦截)</h1><p><a target="_blank" rel="noopener" href="https://adblockplus.org/en/filter-cheatsheet#blocking">点击查看原文</a></p>
<h2 id="简单的拦截规则"><a href="#简单的拦截规则" class="headerlink" title="简单的拦截规则"></a>简单的拦截规则</h2><h3 id="Example1-通过地址拦截"><a href="#Example1-通过地址拦截" class="headerlink" title="Example1: 通过地址拦截"></a>Example1: 通过地址拦截</h3><p><strong>/banner/ * /img ^</strong></p>
<p>banner : 在地址中必须出现banner字样</p>
<p>*可以匹配任意数量的字符</p>
<p>^ 地址可以再此处结束或者接一个分隔符 ? 或 /</p>
<p>以下URL会被这条规则拦截</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://example.com/banner/foo/img</span><br><span class="line">http://example.com/banner/foo/bar/img?param</span><br><span class="line">http://example.com/banner//img/foo</span><br></pre></td></tr></table></figure>

<p>不会被拦截</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://example.com/banner/img</span><br><span class="line">http://example.com/banner/foo/imgraph</span><br><span class="line">http://example.com/banner/foo/img.gif</span><br></pre></td></tr></table></figure>

<h3 id="Example2-通过域名拦截"><a href="#Example2-通过域名拦截" class="headerlink" title="Example2:通过域名拦截"></a>Example2:通过域名拦截</h3><p><strong>||ads.example.com ^</strong></p>
<p>域名必须为ads.example.com</p>
<p>|| ：后接一个域名</p>
<p>^ ：后接一个分隔符 / 或 :</p>
<p>以下URL会被这条规则拦截</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://ads.example.com/foo.gif</span><br><span class="line">http://server1.ads.example.com/foo.gif</span><br><span class="line">https://ads.example.com:8000/</span><br></pre></td></tr></table></figure>

<p>不会被拦截</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://ads.example.com.ua/foo.gif</span><br><span class="line">http://example.com/redirect/http://ads.example.com/</span><br></pre></td></tr></table></figure>

<h3 id="Example3-精确拦截"><a href="#Example3-精确拦截" class="headerlink" title="Example3:精确拦截"></a>Example3:精确拦截</h3><p><strong>| <a target="_blank" rel="noopener" href="http://example.com/">http://example.com/</a></strong></p>
<p>| ：表示后接的 <a target="_blank" rel="noopener" href="http://example.com/%E5%BF%85%E9%A1%BB%E4%B8%BA%E8%A2%AB%E6%8B%A6%E6%88%AA%E5%9C%B0%E5%9D%80%E7%9A%84%E9%A6%96%E9%83%A8">http://example.com/必须为被拦截地址的首部</a></p>
<p>/：</p>
<p>以下URL会被这条规则拦截</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://example.com/</span><br></pre></td></tr></table></figure>

<p>不会被拦截</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://example.com/foo.gif</span><br><span class="line">http://example.info/redirect/http://example.com/</span><br></pre></td></tr></table></figure>

<h2 id="拦截规则的选项"><a href="#拦截规则的选项" class="headerlink" title="拦截规则的选项"></a>拦截规则的选项</h2><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p><strong>|| ads.example.com ^ $ script,image,domain = example.com | ~foo.example.info</strong></p>
<p>这个规则只在两种情况下会拦截 <strong><a target="_blank" rel="noopener" href="http://ads.example.com/foo.gif">http://ads.example.com/foo.gif</a></strong></p>
<ul>
<li>这个url以script或图片的形式加载</li>
<li>页面从<strong>example.com</strong>或其子域加载 并且 不是从<strong>foo.example.com</strong>及其子域名加载</li>
</ul>
<h2 id="覆盖规则"><a href="#覆盖规则" class="headerlink" title="覆盖规则"></a>覆盖规则</h2><p>在拦截规则匹配到该URL时，覆盖规则可以跳过拦截该url</p>
<h3 id="Example-1-覆盖单个请求"><a href="#Example-1-覆盖单个请求" class="headerlink" title="Example 1:覆盖单个请求"></a>Example 1:覆盖单个请求</h3><p><strong>@@ || ads.example.com/notbanner ^ $ ~script</strong></p>
<p>@@：标志这是一个覆盖请求</p>
<p> || ads.example.com/notbanner：这部分的用法和拦截规则相同</p>
<p>$：后接覆盖的类型，这里指覆盖规则不适用于scripts</p>
<h3 id="Example-2-覆盖整个网站"><a href="#Example-2-覆盖整个网站" class="headerlink" title="Example 2:覆盖整个网站"></a>Example 2:覆盖整个网站</h3><p><strong>@@ || example.com ^ $ document</strong></p>
<p>examaple.com：用法和拦截规则一样，表示覆盖规则适用于example.com整个网站</p>
<p>$：后接覆盖的类型，这里指整个网页都会被覆盖</p>
<h2 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h2><p>注释</p>
<p>syntax：<code>!这是一个注释</code></p>
<footer>更多拦截类型请至<a target="_blank" rel="noopener" href="https://adblockplus.org/en/filter-cheatsheet#blocking">原文</a>查阅</footer>



      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/03/08/%E8%87%AA%E5%AE%9A%E4%B9%89PAC/" data-id="cko7betf7000kqqseguqz1hej" class="article-share-link" data-share="baidu" data-title="自定义PAC">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/03/08/%E8%87%AA%E5%AE%9A%E4%B9%89PAC/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-2021-3-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/02/2021-3-2/" class="article-date">
  <time datetime="2021-03-02T08:32:02.000Z" itemprop="datePublished">2021-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python3-2021%E6%98%A5/">Python3_2021春</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/02/2021-3-2/">2021/03/02</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="2021-3-2"><a href="#2021-3-2" class="headerlink" title="2021.3.2"></a>2021.3.2</h1><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><h3 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h3><p>python数字大小不受限制</p>
<p>python 用地址代表变量,类似指针,变量可随时转类型</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = <span class="number">3</span></span><br><span class="line">print(<span class="built_in">id</span>(x))</span><br></pre></td></tr></table></figure>

<p>范围 -5 ~ 256</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">y=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line">print(<span class="built_in">id</span>(y[<span class="number">1</span>]) == <span class="built_in">id</span>(y[<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<p>变量以字母开头，下划线开头有特殊意义</p>
<h3 id="复数"><a href="#复数" class="headerlink" title="复数"></a>复数</h3><p>example:<br><code>x = 3 + 4j</code></p>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p><code>x = &#39;hello world&#39;</code></p>
<h3 id="字节串"><a href="#字节串" class="headerlink" title="字节串"></a>字节串</h3><p><code>&#39;Hello world&#39;.encode(&#39;utf-8&#39;)</code></p>
<p><code>decode()</code></p>
<h3 id="字典-HashMap"><a href="#字典-HashMap" class="headerlink" title="字典(HashMap)"></a>字典(HashMap)</h3><h3 id="列表-list"><a href="#列表-list" class="headerlink" title="列表(list)"></a>列表(list)</h3>
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/03/02/2021-3-2/" data-id="cko7betec0001qqse89z672op" class="article-share-link" data-share="baidu" data-title="2021/03/02">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/03/02/2021-3-2/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-HashMap源码分析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/25/HashMap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" class="article-date">
  <time datetime="2021-02-25T11:31:09.000Z" itemprop="datePublished">2021-02-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/25/HashMap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">HashMap源码分析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="HashMap源码分析"><a href="#HashMap源码分析" class="headerlink" title="HashMap源码分析"></a>HashMap源码分析</h1><h2 id="put方法"><a href="#put方法" class="headerlink" title="put方法"></a>put方法</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">               ,<span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">  Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">  <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">    n = (tab = resize()).length;</span><br><span class="line">  <span class="comment">//未检测到哈希冲突,直接将键值对插入节点</span></span><br><span class="line">  <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">    tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    Node&lt;K,V&gt; e; K k;d</span><br><span class="line">    <span class="comment">//节点的值与插入的值相同,将e指向p</span></span><br><span class="line">    <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">        ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">      e = p;</span><br><span class="line">    <span class="comment">//桶为红黑树,调用红黑树插入方法</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">      e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">    <span class="keyword">else</span> &#123;<span class="comment">//在链表中查找</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">        <span class="comment">//链表中不包含要插入的值</span></span><br><span class="line">        <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">          p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">          <span class="comment">//若链表长度超出阈值，对链表进行扩容</span></span><br><span class="line">          <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">            treeifyBin(tab, hash);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//链表中存在与插入值相同键值对，终止遍历</span></span><br><span class="line">        <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">            ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        p = e;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//若存在与插入键值对相同的key，则对value进行更新</span></span><br><span class="line">    <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">      V oldValue = e.value;</span><br><span class="line">      <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">        e.value = value;</span><br><span class="line">      afterNodeAccess(e);</span><br><span class="line">      <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ++modCount;</span><br><span class="line">  <span class="comment">//如果超出阈值，进行扩容</span></span><br><span class="line">  <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">    resize();</span><br><span class="line">  afterNodeInsertion(evict);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="get方法"><a href="#get方法" class="headerlink" title="get方法"></a>get方法</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class="keyword">int</span> n; K k;</span><br><span class="line">  	<span class="comment">//判断hash表对应位置是否为空与hash表是否有意义</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//将搜索键值对的key与哈希表第一个节点进行比较</span></span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">//如果是红黑树类型，调用红黑树进行查找</span></span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            <span class="comment">//对链表进行查找</span></span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/02/25/HashMap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" data-id="cko7beten0006qqse1iip3f4s" class="article-share-link" data-share="baidu" data-title="HashMap源码分析">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/02/25/HashMap%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-git-learning-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/24/git-learning-1/" class="article-date">
  <time datetime="2021-02-24T05:03:35.000Z" itemprop="datePublished">2021-02-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/git/">git</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/24/git-learning-1/">git基础命令</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="git的基础使用"><a href="#git的基础使用" class="headerlink" title="git的基础使用"></a>git的基础使用</h1><h2 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h2><p>安装</p>
<p><code>home brew install git</code></p>
<p>检查版本</p>
<p><code>git --version</code></p>
<p>设置用户名与密码</p>
<p>此处设置的电子邮件将会显示在提交记录中</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git conig --global user.name &lt;用户名&gt;</span><br><span class="line">git cofig --global user.email &lt;电子邮件&gt;</span><br></pre></td></tr></table></figure>

<h2 id="操作本地仓库"><a href="#操作本地仓库" class="headerlink" title="操作本地仓库"></a>操作本地仓库</h2><p>建立本地仓库</p>
<p>cd 到仓库对应的目录中</p>
<p><code>git init</code></p>
<p>添加文件至索引</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git add &quot;文件名&quot;           添加单个文件</span><br><span class="line">git add .		  添加全部文件</span><br></pre></td></tr></table></figure>

<p>检查提交文件状态</p>
<p><code>git status</code></p>
<p>提交索引</p>
<p><code>git commit -m &quot;commit信息&quot;</code></p>
<h2 id="操作远程数据库"><a href="#操作远程数据库" class="headerlink" title="操作远程数据库"></a>操作远程数据库</h2><p>将远程数据库与本地数据库绑定</p>
<p><code>git remote add origin 远程数据库url</code></p>
<p>克隆远程数据库至本地</p>
<p><code>git clone 远程数据库url</code> </p>
<h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3><p>提交commit，master 为远程数据库对应的分支</p>
<p><code>git push -u origin master</code></p>
<h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><p>从远程数据库拉取信息</p>
<p><code>git pull origin master</code></p>
<h2 id="修改冲突"><a href="#修改冲突" class="headerlink" title="修改冲突"></a>修改冲突</h2><p><img src="https://backlog.com/git-tutorial/cn/img/post/intro/capture_intro5_1_1.png" alt="来自"></p>
<center>引用自<a target="_blank" rel="noopener" href="https://backlog.com/git-tutorial/cn/intro/intro5_1.html">猴子都能懂得git入门</a> </center>

<p>​    从上图可以看到，若在git pull 之前，有别的数据库对远程数据库更新，那么强行提交就会丢失别的数据库对远程数据库的更新，所以在进行git push之前要先通过git pull 拉取远程数据库的内容</p>
<p>​    若在git pull时，本次更新与远程数据库的更新对同一个文件进行了修改，则无法提交，需要手动修改冲突</p>
<p><img src="https://backlog.com/git-tutorial/cn/img/post/intro/capture_intro5_1_3.png"></p>
<center>引用自<a target="_blank" rel="noopener" href="https://backlog.com/git-tutorial/cn/intro/intro5_1.html">猴子都能懂得git入门</a> </center>

<p>==分割线上方是本地数据库的内容,<br>下方是远程数据库的编辑内容</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/02/24/git-learning-1/" data-id="cko7beteu0008qqsehhiwdopa" class="article-share-link" data-share="baidu" data-title="git基础命令">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/02/24/git-learning-1/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  
    <article id="post-article-title" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/24/article-title/" class="article-date">
  <time datetime="2021-02-24T02:06:09.000Z" itemprop="datePublished">2021-02-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/24/article-title/">第一篇文章</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>我的第一篇文章</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://codeyongqi.github.io/2021/02/24/article-title/" data-id="cko7betet0007qqseg8ob74t6" class="article-share-link" data-share="baidu" data-title="第一篇文章">分享到</a>
      

      
        <a href="https://codeyongqi.github.io/2021/02/24/article-title/#ds-thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">下一页 &amp;raquo;</a>
  </nav>
</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Python3-2021%E6%98%A5/">Python3_2021春</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/">技术文章翻译</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 10px;">数据库</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/04/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E5%8F%91%E5%A4%84%E7%90%86/">数据库并发处理</a>
          </li>
        
          <li>
            <a href="/2021/04/09/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1/">数据库事务</a>
          </li>
        
          <li>
            <a href="/2021/03/16/hit-oslab-1/">哈工大操作系统实验 Hit-oslab 环境搭建指南</a>
          </li>
        
          <li>
            <a href="/2021/03/09/2021-3-9/">2021-3-9</a>
          </li>
        
          <li>
            <a href="/2021/03/08/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/">技术文章翻译</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://arvinxiang.com" target="_blank">主题作者</a>
          </li>
        
          <li>
            <a href="http://reqianduan.com" target="_blank">热前端</a>
          </li>
        
          <li>
            <a href="http://yuancheng.work" target="_blank">远程.work</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 朱勇麒<br>
      Powered by <a href="//hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!-- 多说公共js代码 start -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"reqianduan"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共js代码 end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>





<script src="/js/script.js"></script>


</div>
</body>
</html>
